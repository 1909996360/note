<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>html转pdf</title>
</head>
<style>
  html{
    width:894px;
    margin: 0 auto;
    /* border: 1px solid #ccc; */
  }
  body{
    padding: 10px;
  }
  .container-title{
    font-weight: bold;
  }
  div{
    margin: 20px 0;
  }
  tr,td{
    text-align: center;
  }
</style>
<body>
    <div class="container-div">
      <div class="container-title">
         <div class="title" style="font-weight: bold;font-size: 20px;text-align: center;">
           南沙区随约平台运营情况工作汇报
         </div>
         <!-- <div class="time" style="font-weight: bold;color: red;text-align: center;">
            数据统计截止时间:<span style="margin-bottom: -10px;">2022-2-27日0点</span>
         </div>
         <div class="desc" style="line-height:40px">
          <span class="desc-span" style="font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;总述：</span>
          <span class="desc-all" style="font-weight: 400;">南沙区一共<span style="margin-top: 5px;">9</span>个街镇 169 个村居，现已有 149 个村居开通随约平台管理员账号，22 个村居导入社区（村/居）组织架构，13 个村居在随约平台创建工
            作沟通群。</span>
         </div> -->
      </div>
      <div class="table-div">
          <div class="table-title" style="text-indent: 20px;">
            一、平台建设完成情况汇总（双周提供）
          </div>
          <div class="table-second-title" style="text-indent: 20px;">
            (一) 平台注册用户
          </div>
          <div class="table-third-title" style="text-indent: 20px;font-weight: bold;">
            1. 全区随约平台注册用户统计表
          </div>
          <!--平台注册用户统计表-->
          <div class="table-container-first">
            <table style="background-color: #fff2cc;" class="account-table" border="1" width="894" bordercolor="black" cellspacing="0" cellpadding="5">
              <tr>
                <td colspan="5">海珠区随约平台注册用户统计表</td>
              </tr>
              <tr>
                <td style="font-weight: bold;">街镇名称</td>
                <td style="font-weight: bold;">累计用户数</td>
                <td>近两周新增用户</td>
                <td>示范社区累计注册用户数</td>
                <td>非示范社区累计注册用户数</td>
              </tr>
              <!--tr表示一行，td表示一列-->
              
              </table>
          </div>
          <div class="table-third-title" style="text-indent: 20px;">
            2. 示范社区注册用户数统计表
          </div>
          <!--全区随约平台注册用户统计表-->
          <div class="table-container-second">
            <table style="background-color: #e2efda;" class="register-table" border="1" width="894" bordercolor="black" cellspacing="0" cellpadding="5">
              <tr>
                <td colspan="4">海珠区随约平台示范社区注册用户统计表</td>
              </tr>
              <tr>
                
                <td style="font-weight: bold;">社区名称</td>
                <td>近两周新增用户</td>
                <td>累计注册用户数</td>
                <td style="font-weight: bold;">街镇名称</td>
              </tr>
              <!--tr表示一行，td表示一列-->
              
              </table>
          </div>
          <div class="table-third-title" style="text-indent: 20px;">
            3. 非示范社区注册用户数统计表；
          </div>
          <!--非示范社区注册用户统计表-->
          <div class="table-container-third">
            <table class="orgCode-reigister-table" border="1" width="894" bordercolor="black" cellspacing="0" cellpadding="5">
              <tr>
                <td colspan="4">海珠区随约平台非示范社区注册用户统计表</td>
              </tr>
              <tr>
                <td style="font-weight: bold;">社区名称</td>
                <td style="font-weight: bold;">近两周新增用户</td>
                <td style="font-weight: bold;">累计注册用户数</td>
                <td style="font-weight: bold;">街镇名称</td>
              </tr>
          
              </table>
          </div>
        
          <div class="table-third-title" style="text-indent: 20px;">
            (二) 社区组织动员体系（含示范社区和非示范社区）：
          </div>
          <div class="table-third-title" style="text-indent: 20px;font-weight: bold;">
            1. 全区社区组织动员体系建设情况一览表
          </div>
          <!--全区社区组织动员体系建设情况一览表-->
          <div class="table-container-fourth">
            <table class="dongyuan-table" border="1" width="894" bordercolor="black" cellspacing="0" cellpadding="5">
                <tr>
                  <td>指标</td>
                  <td>市级示范社区</td>
                  <td>区级示范社区</td>
                  <td>非示范社区</td>
                  <td>新增数</td>
                  <td>合计</td>
                </tr>
             </table>
          </div>
          <div class="table-third-title" style="text-indent: 20px;font-weight: bold;">
            2. 示范社区“社区组织动员体系”（居民/网上家园）建设情况统计
          </div>
          <!--示范社区动员组织体系-->
          <div class="table-container-firth">
            <table class="dongyuan-build-table" border="1" width="894" bordercolor="black" cellspacing="0" cellpadding="5">
              <tr>
                <td colspan="4">海珠区随约平台示范社区社区动员体系建设情况统计表</td>
              </tr>
              <tr>
                
                <td style="font-weight: bold;">社区名称</td>
                <td>近两周新增用户</td>
                <td>累计用户数</td>
                <td style="font-weight: bold;">街镇名称</td>
              </tr>
              <!--tr表示一行，td表示一列-->
              
              </table>
          </div>
          <div class="table-third-title" style="text-indent: 20px;font-weight: bold;">
            3. 非示范社区“社区组织动员体系”（居民/网上家园）入驻情况
          </div>
          <!--非示范社区动员体系入驻情况-->
          <div class="table-container-firth">
            <table class="dongyuan-reBuild-table" border="1" width="894" bordercolor="black" cellspacing="0" cellpadding="5">
              <tr>
                <td colspan="4">海珠区随约平台示范社区社区动员体系建设情况统计表</td>
              </tr>
              <tr>
                
                <td style="font-weight: bold;">社区名称</td>
                <td>近两周新增用户</td>
                <td>累计用户数</td>
                <td style="font-weight: bold;">街镇名称</td>
              </tr>
              <!--tr表示一行，td表示一列-->
              
              </table>
          </div>
          <div class="table-third-title" style="text-indent: 20px;font-weight: bold;">
            4. 其他数据情况
          </div>
          <div class="table-container-seventh">
            <table class="other-table" border="1" width="894" bordercolor="black" cellspacing="0" cellpadding="5">
              <tr>
                <td style="font-weight: bold;">名称</td>
                <td>数量</td>
                <td>备注</td>
              </tr>
              <!--tr表示一行，td表示一列-->
              
              </table>
          </div>
      </div>
      <div class="footer-div">
        <div class="footer-continer" style="text-align: right;text-indent: 20px;">
          随约网上驿站运营单位：
        </div>
        <div class="footer-continer" style="text-align: right;text-indent: 20px;">
         广州列丰信息科技有限公司
        </div>
        <div class="footer-continer" style="text-align: right;text-indent: 20px;">
         2022.02.28
        </div>
      </div>
      <div class="footer-div">
        <div class="footer-continer" class="footer-continer" style="text-align: right;text-indent: 20px;">
          联系人：谭南
        </div>
        <div class="footer-continer" class="footer-continer" style="text-align: right;text-indent: 20px;">
          联系方式：15915744691
        </div>
      </div>
    </div>
    


    <script>
      // 创建一个假数组
      var accountList = [
        {
          streetName:'大岗村',
          orgNum:'32',
          takeAcc:'31',
          noneAcc:'1',
          onlyOne:'2'
        },
        {
          streetName:'东涌村',
          orgNum:'32',
          takeAcc:'31',
          noneAcc:'1',
          onlyOne:'2'
        },
        {
          streetName:'横沥村',
          orgNum:'32',
          takeAcc:'31',
          noneAcc:'1',
          onlyOne:'2'
        },
        {
          streetName:'黄阁村',
          orgNum:'32',
          takeAcc:'31',
          noneAcc:'1',
          onlyOne:'2'
        },
        {
          streetName:'小计',
          orgNum:'169',
          takeAcc:'149',
          noneAcc:'20',
          onlyOne:'26'
        },
      ]
      // 创建一个假数组
      var registerList = [
        {
          streetName:'南沙街道',
          list:[
            {
              num:'1',
              orgName:'南沙社区',
              count:'100'
            },
            {
              num:'2',
              orgName:'逸涛社区',
              count:'100'
            },
            {
              num:'3',
              orgName:'南北台社区',
              count:'100'
            },
          ]
        },
        {
          streetName:'黄阁镇',
          list:[
            {
              num:'4',
              orgName:'黄阁社区',
              count:'100'
            },
            {
              num:'5',
              orgName:'梅山社区',
              count:'100'
            },
            {
              num:'6',
              orgName:'凤凰社区',
              count:'100'
            },
          ]
        },
        {
          streetName:'万顷沙镇',
          list:[
            {
              num:'7',
              orgName:'年丰村',
              count:'100'
            }
          ]
        },
      ]
      
      // 创建一个示范社区注册用户统计表
      var orgCodeRegisterList = [
        {
          streetName:'南沙街道',
          list:[
            {
              num:'1',
              orgName:'南沙社区',
              count:'100'
            },
            {
              num:'2',
              orgName:'逸涛社区',
              count:'100'
            },
            {
              num:'3',
              orgName:'南北台社区',
              count:'100'
            },
          ]
        },
        {
          streetName:'黄阁镇',
          list:[
            {
              num:'4',
              orgName:'黄阁社区',
              count:'100'
            },
            {
              num:'5',
              orgName:'梅山社区',
              count:'100'
            },
            {
              num:'6',
              orgName:'凤凰社区',
              count:'100'
            },
          ]
        },
        {
          streetName:'万顷沙镇',
          list:[
            {
              num:'7',
              orgName:'年丰村',
              count:'100'
            }
          ]
        },
      ]
      
      // 创建全区社区动员体系情况一览表
      var dongyuanList = [
        {
          zhibiao:'基本数据',
          shiji:'4',
          quji:'12',
          fei:'133',
          add:'新增数',
          account:'149'
        },
        {
          zhibiao:'完成组织架构导入的社区',
          shiji:'4',
          quji:'12',
          fei:'133',
          add:'新增数',
          account:'149'
        },
        {
          zhibiao:'已启动推广的社区',
          shiji:'4',
          quji:'12',
          fei:'133',
          add:'新增数',
          account:'149'
        },
        {
          zhibiao:'入驻人数',
          shiji:'4',
          quji:'12',
          fei:'133',
          add:'新增数',
          account:'149'
        },
        {
          zhibiao:'已创建工作群的社区',
          shiji:'4',
          quji:'12',
          fei:'133',
          add:'新增数',
          account:'149'
        },
        {
          zhibiao:'辖区共建单位入住数量',
          shiji:'4',
          quji:'12',
          fei:'133',
          add:'新增数',
          account:'149'
        },
        {
          zhibiao:'提供服务的市场主题数量',
          shiji:'4',
          quji:'12',
          fei:'133',
          add:'新增数',
          account:'149'
        },
      ]
      // 创建社区组织动员体系建设情况统计表

      var dongyuanBuildList = [
        {
          streetName:'南沙街道',
          list:[
            {
              num:'1',
              orgName:'南沙社区',
              count:'100'
            },
            {
              num:'2',
              orgName:'逸涛社区',
              count:'100'
            },
            {
              num:'3',
              orgName:'南北台社区',
              count:'100'
            },
          ]
        },
        {
          streetName:'黄阁镇',
          list:[
            {
              num:'4',
              orgName:'黄阁社区',
              count:'100'
            },
            {
              num:'5',
              orgName:'梅山社区',
              count:'100'
            },
            {
              num:'6',
              orgName:'凤凰社区',
              count:'100'
            },
          ]
        },
        {
          streetName:'万顷沙镇',
          list:[
            {
              num:'7',
              orgName:'年丰村',
              count:'100'
            }
          ]
        },
      ]
     
      // 创建非示范社区动员组织体系入驻情况统计表
      var dongyuanReBuildList = [
        {
          streetName:'南沙街道',
          list:[
            {
              num:'1',
              orgName:'南沙社区',
              count:'100'
            },
            {
              num:'2',
              orgName:'逸涛社区',
              count:'100'
            },
            {
              num:'3',
              orgName:'南北台社区',
              count:'100'
            },
          ]
        },
        {
          streetName:'黄阁镇',
          list:[
            {
              num:'4',
              orgName:'黄阁社区',
              count:'100'
            },
            {
              num:'5',
              orgName:'梅山社区',
              count:'100'
            },
            {
              num:'6',
              orgName:'凤凰社区',
              count:'100'
            },
          ]
        },
        {
          streetName:'万顷沙镇',
          list:[
            {
              num:'7',
              orgName:'年丰村',
              count:'100'
            }
          ]
        },
      ]
     
      // 创建其他数据情况统计表 
      var otherList = [
         {
            name:'全区随约平台累计访问次（人数）',
            num:'22',
            desc:''
          },
         {
            name:'居民参与社区活动（人次）',
            num:'22',
            desc:''
          },
         {
            name:'平台信息总阅读数（人次）',
            num:'22',
            desc:''
          },
         {
            name:'用户数据覆盖街镇数',
            num:'22',
            desc:''
          },
         {
            name:'用户数据覆盖社区数',
            num:'22',
            desc:''
          },
         {
            name:'在随约平台提供服务的街镇数量',
            num:'22',
            desc:''
          },
      ]

      // 循环遍历各村镇平台账号申请开通情况方法
      function setAccountList(accountList,name){
        var className = document.getElementsByClassName(name)
        if(accountList && accountList.length){
          let lastCount = accountList.pop()
          for(let i = 0; i < accountList.length;i++ ){
            // 动态创建tr
            let tr = document.createElement('tr')
            className[0].appendChild(tr)
            let obj = accountList[i]
            if(obj){
              Object.keys(obj).forEach((key,index)=>{
                  let td = document.createElement('td')
                  td.innerHTML = obj[key]
                  tr.appendChild(td) 
              })
            }
          }
          if(lastCount){
            let tr = document.createElement('tr')
            className[0].appendChild(tr)
            Object.keys(lastCount).forEach((key)=>{
              let td = document.createElement('td')
              // if(lastCount[key] == '小计'){
              //   td.colSpan = '2'
              // }
              td.innerHTML = lastCount[key]
              // td.style.fontWeight = 'bold'
              // td.style.fontSize = '20px'
              tr.appendChild(td)
              
            })
          }
        }
      }
      
      // 循环遍历示范社区用户统计表
      function registerFun(list,name){
        let className = document.getElementsByClassName(name)
        if(list && list.length){
            for(let i = 0 ; i < list.length; i++){
              let item = list[i] 
              // 动态创建tr
              if(item.list && item.list.length){
                for(let j = 0 ; j <item.list.length;j++){
                    if(j == 0){
                        item.list[j].streetName = item.streetName
                    }
                    let listItem = item.list[j]
                    let tr = document.createElement('tr')
                    className[0].appendChild(tr)
                    Object.keys(listItem).forEach((key)=>{
                      let td = document.createElement('td')
                      if(key == 'streetName'){
                        td.rowSpan = item.list.length
                      }
                      td.innerHTML = listItem[key]
                      tr.appendChild(td)
                })
              }
            }  
          }
        }
        console.log('list',list);
      } 

      // 改变对象的属性顺序
      function objsort(obj){
          var keyArr = [],valArr = [];
          for (var key in obj) {
                  keyArr.push(key);
                  valArr.push(obj[key]);
          }
          console.log('keyArr',keyArr);
          console.log('valArr',valArr);

          for (var i = 0, len = valArr.length; i < len; i++) {
              for (var j = 0; j < len - i; j++) {
                var keyTemp, valTemp;
                if (valArr[j] < valArr[j + 1]) {  //从大到小排序
                //if (valArr[j] > valArr[j + 1]) { //从小到大排序
                      valTemp = valArr[j];
                      valArr[j] = valArr[j + 1];
                      valArr[j+1] = valTemp;
                      keyTemp = keyArr[j];
                      keyArr[j] = keyArr[j + 1];
                      keyArr[j+1] = keyTemp;
                  }
              }
          }
          var newobj={};
          for(var i=0;i<valArr.length;i++){
              newobj[''+keyArr[i]+'']=obj[keyArr[i]];
          }
          return newobj;
      }



      // 调用平台注册用户统计表方法
      setAccountList(accountList,'account-table')
      // 调用遍历全区随约平台注册用户统计表
      registerFun(registerList,'register-table')
      // 调用遍历示范社区用户数统计表方法
      registerFun(orgCodeRegisterList,'orgCode-reigister-table')

      // 调用全区社区组织动员体系建设情况一览表
      setAccountList(dongyuanList,'dongyuan-table')
       // 示范社区组织动员体系建设情况统计
      registerFun(dongyuanBuildList,'dongyuan-build-table')
      //  非示范社区组织动员体系入驻情况统计
      registerFun(dongyuanReBuildList,'dongyuan-reBuild-table')
      //  其他情况数据
      setAccountList(otherList,'other-table')
      console.log(document.documentElement.outerHTML)
    </script>
</body>
</html>